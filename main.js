(()=>{"use strict";class t{constructor(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.parentEl=t,this.lastActiveCardEl=void 0,this.showImages=e,this.showDescription=s}static get formHTML(){return'\n        <form id="form" class="cardnumber-form-widget form-inline row g-2" novalidate="novalidate">\n          <div class="form-group col-md-8 mt-1">\n              <input class="form-control input" id="cardnumber-input" name="card_number" type="text" placeholder="Введите номер карты" aria-describedby="cardnumber-feeddback">\n              <div id="cardnumber-invalid-feedback" class="invalid-feedback">Карта не идентифицирована</div>\n              <div id="cardnumber-valid-feedback" class="valid-feedback">Карта не идентифицирована</div>\n          </div>\n          <button type="submit" id="cardnumber-submit" class="submit btn btn-success col-md-4 mt-1" title="Нажмите для проверки карты">Проверить</button>\n        </form>'}static get imagesCardsHTML(){return'\n        <ul class="cards list-unstyled">\n          <li><span class="card visa disabled" title="Visa"></span></li>\n          <li><span class="card master disabled" title="Mastercard"></span></li>\n          <li><span class="card amex disabled" title="American Express"></span></li>\n          <li><span class="card discover disabled" title="Discover"></span></li>\n          <li><span class="card jcb disabled" title="JCB"></span></li>\n          <li><span class="card diners disabled" title="Diners Club"></span></li>\n          <li><div class="card mir disabled" title="МИР"></div></li>\n        </ul>\n        '}static get descriptionHTML(){return'\n        <h3 class="text-center mt-2">Примеры номеров банковских карт</h3>\n        <table class="table table-striped table-bordered" style="width:100%">\n            <thead class="text-center">\n                <tr class="">\n                    <th>Тип карты</th>\n                    <th>Логотип</th>\n                    <th>Примеры номеров</th>\n                </tr>\n            </thead>\n            <tbody>\n                <tr>\n                    <td>American Express</td>\n                    <th class="d-flex justify-content-center"><div class="card amex" title="American Express"></div></th>\n                    <td>348446461372266</td>\n                </tr>\n                <tr>\n                    <td>Diners Club</td>\n                    <th class="d-flex justify-content-center"><div class="card diners" title="Diners Club"></div></th>\n                    <td>36471414338070</td>\n                </tr>\n                <tr>\n                    <td>Discover</td>\n                    <th class="d-flex justify-content-center"><div class="card discover" title="Discover"></div></th>\n                    <td>6011168785829283</td>\n                </tr>\n                <tr>\n                    <td>JCB</td>\n                    <th class="d-flex justify-content-center"><div class="card jcb" title="JCB"></div></th>\n                    <td>3529992726838059</td>\n                </tr>\n                <tr>\n                    <td>MasterCard</td>\n                    <th class="d-flex justify-content-center"><div class="card master" title="MasterCard"></div></th>\n                    <td>5346028387436812</td>\n                </tr>\n                <tr>\n                    <td>Visa</td>\n                    <th class="d-flex justify-content-center"><div class="card visa" title="Visa"></div></th>\n                    <td>4556737586899855</td>\n                </tr>\n                <tr>\n                    <td>МИР</td>\n                    <th class="d-flex justify-content-center"><div class="card mir" title="МИР"></div></th>\n                    <td>2200240768512994</td>\n                </tr>\n            </tbody>\n        </table>'}static get inputSelector(){return"[id=cardnumber-input]"}static get submitSelector(){return"[id=cardnumber-submit]"}static get validFeedbackSelector(){return"[id=cardnumber-valid-feedback]"}bindToDOM(){this.parentEl.innerHTML=this.showImages?t.imagesCardsHTML+t.formHTML:t.formHTML,this.parentEl.innerHTML=this.showDescription?this.parentEl.innerHTML+t.descriptionHTML:this.parentEl.innerHTML,this.parentEl.querySelector(t.submitSelector).addEventListener("click",(t=>this.onSubmit(t)))}onSubmit(e){e.preventDefault();const s=this.parentEl.querySelector(t.inputSelector),i=function(t){const e=[{class:"amex",titlе:"American Express",regexp:"^3[47][0-9]{13}$"},{class:"diners",titlе:"Diners Club",regexp:"^3(?:0[0-5]|[68][0-9])[0-9]{11}$"},{class:"diners",titlе:"Diners Club",regexp:"^3(?:0[0-5]|[68][0-9])[0-9]{11}$"},{class:"discover",titlе:"Discovery",regexp:"^65[4-9][0-9]{13}|64[4-9][0-9]{13}|6011[0-9]{12}|(622(?:12[6-9]|1[3-9][0-9]|[2-8][0-9][0-9]|9[01][0-9]|92[0-5])[0-9]{10})$"},{class:"jcb",titlе:"JCB",regexp:"^(?:2131|1800|35[0-9]{3})[0-9]{3,}$"},{class:"visa",titlе:"VISA",regexp:"^4[0-9]{12}(?:[0-9]{3})?$"},{class:"master",titlе:"MasterCard",regexp:"^(5[1-5][0-9]{14}|2(22[1-9][0-9]{12}|2[3-9][0-9]{13}|[3-6][0-9]{14}|7[0-1][0-9]{13}|720[0-9]{12}))$"},{class:"mir",titlе:"МИР",regexp:"^220([0-4])[0-9]{12}$"}];if(function(t){let e=0;const s=String(t).split("").reverse().map(Number),i=s[0];for(let t=1;t<s.length;t++)t%2!=0&&(s[t]=2*s[t],s[t]>9&&(s[t]-=9)),e+=s[t];return Boolean((e%10==0?e%10:10-e%10)===i)}(t))for(let s of e)if(new RegExp(s.regexp).test(t))return[s.class,s.titlе];return!1}(s.value);if(i){if(this.parentEl.querySelector(t.validFeedbackSelector).innerHTML=`Карта идентифицирована - ${i[1]}`,s.classList.remove("is-invalid"),s.classList.add("is-valid"),this.showImages){void 0!==this.lastActiveCardEl&&this.lastActiveCardEl.classList.add("disabled");const t=this.parentEl.querySelector(`.${i[0]}`);t.classList.remove("disabled"),this.lastActiveCardEl=t}}else s.classList.add("is-invalid"),s.classList.remove("is-valid"),this.showImages&&void 0!==this.lastActiveCardEl&&this.lastActiveCardEl.classList.add("disabled")}}new t(document.querySelector("#widget-container")).bindToDOM()})();